module Day12 where

  data NI = N Int | S Int | E Int | W Int | L Int | R Int | F Int
    deriving (Eq, Ord, Show)

  data Dir = North | South | East | West
    deriving (Eq, Ord, Show)

  data Pos = Pos Int Int
    deriving (Eq, Ord, Show)

  data Ship1 = Ship1 Dir Pos
    deriving (Eq, Ord, Show)
  ship1Direction (Ship1 d _) = d
  ship1Position  (Ship1 _ p) = p

  turn  90 North = East
  turn  90 East  = South
  turn  90 South = West
  turn  90 West  = North

  turn 180 North = South
  turn 180 East  = West
  turn 180 South = North
  turn 180 West  = East

  turn 270 North = West
  turn 270 East  = North
  turn 270 South = East
  turn 270 West  = South


  act1 (Ship1 d (Pos ns ew)) (N x) = Ship1 d (Pos (ns + x) ew     )
  act1 (Ship1 d (Pos ns ew)) (S x) = Ship1 d (Pos (ns - x) ew     )
  act1 (Ship1 d (Pos ns ew)) (E x) = Ship1 d (Pos  ns     (ew + x))
  act1 (Ship1 d (Pos ns ew)) (W x) = Ship1 d (Pos  ns     (ew - x))

  act1 (Ship1 d p) (R x) = Ship1 (turn        x  d) p
  act1 (Ship1 d p) (L x) = Ship1 (turn (360 - x) d) p

  act1 (Ship1 North (Pos ns ew)) (F x) = Ship1 North (Pos (ns + x) ew     )
  act1 (Ship1 South (Pos ns ew)) (F x) = Ship1 South (Pos (ns - x) ew     )
  act1 (Ship1 East  (Pos ns ew)) (F x) = Ship1 East  (Pos  ns     (ew + x))
  act1 (Ship1 West  (Pos ns ew)) (F x) = Ship1 West  (Pos  ns     (ew - x))


  moves1 s = foldl act1 s
  trace1 s = scanl act1 s

  startingShip1 = Ship1 East (Pos 0 0)
  ss1 = startingShip1

  manhattanDistance (Pos ns ew) = abs ns + abs ew



  data Waypoint = Waypoint Int Int
    deriving (Eq, Ord, Show)

  rotate  90 (Waypoint ns ew) = Waypoint (negate ew)         ns
  rotate 180 (Waypoint ns ew) = Waypoint (negate ns) (negate ew)
  rotate 270 (Waypoint ns ew) = Waypoint         ew  (negate ns)

  move (Waypoint ns ew) (N x) = Waypoint (ns + x) ew
  move (Waypoint ns ew) (S x) = Waypoint (ns - x) ew
  move (Waypoint ns ew) (E x) = Waypoint  ns     (ew + x)
  move (Waypoint ns ew) (W x) = Waypoint  ns     (ew - x)

  data Ship2 = Ship2 Waypoint Pos
    deriving (Eq, Ord, Show)
  ship2Waypoint (Ship2 w p) = w
  ship2Position (Ship2 _ p) = p


  act2 (Ship2 wp p) ni@(N _) = Ship2 (move wp ni) p
  act2 (Ship2 wp p) ni@(S _) = Ship2 (move wp ni) p
  act2 (Ship2 wp p) ni@(E _) = Ship2 (move wp ni) p
  act2 (Ship2 wp p) ni@(W _) = Ship2 (move wp ni) p

  act2 (Ship2 wp p) (R x) = Ship2 (rotate        x  wp) p
  act2 (Ship2 wp p) (L x) = Ship2 (rotate (360 - x) wp) p

  act2 (Ship2 wp@(Waypoint ns' ew') (Pos ns ew)) (F x) = Ship2 wp (Pos (ns + x * ns') (ew + x * ew'))


  moves2 s = foldl act2 s
  trace2 s = scanl act2 s

  startingShip2 = Ship2 (Waypoint 1 10) (Pos 0 0)
  ss2 = startingShip2



  xs = [F 99,
        L 180,
        W 1,
        W 3,
        R 90,
        E 5,
        R 180,
        S 4,
        F 55,
        L 90,
        E 5,
        S 3,
        R 180,
        N 2,
        W 3,
        S 1,
        F 64,
        W 4,
        F 76,
        N 2,
        F 7,
        L 180,
        S 2,
        E 5,
        S 2,
        F 87,
        N 4,
        L 90,
        F 46,
        R 90,
        F 47,
        W 5,
        N 4,
        L 270,
        N 5,
        F 89,
        L 180,
        W 2,
        N 5,
        F 69,
        E 3,
        L 90,
        F 73,
        L 90,
        N 1,
        F 28,
        N 4,
        F 72,
        L 90,
        F 24,
        R 90,
        S 1,
        F 52,
        L 90,
        W 2,
        F 39,
        E 1,
        L 180,
        S 4,
        W 1,
        S 2,
        F 61,
        E 3,
        F 37,
        S 1,
        W 3,
        F 8,
        S 5,
        L 90,
        N 5,
        E 2,
        L 180,
        F 44,
        W 3,
        S 1,
        R 90,
        F 88,
        N 1,
        F 75,
        S 2,
        W 2,
        F 37,
        N 4,
        E 3,
        R 90,
        F 47,
        N 5,
        W 5,
        L 90,
        S 4,
        E 5,
        F 7,
        R 90,
        E 5,
        R 90,
        W 2,
        F 56,
        S 2,
        R 270,
        S 1,
        W 3,
        S 2,
        W 2,
        F 79,
        W 4,
        N 5,
        W 3,
        F 84,
        L 90,
        N 5,
        E 2,
        F 48,
        E 1,
        L 180,
        E 4,
        L 90,
        W 4,
        E 4,
        S 4,
        W 4,
        F 36,
        F 93,
        L 180,
        W 5,
        S 1,
        E 5,
        F 96,
        N 3,
        E 3,
        N 2,
        R 270,
        W 5,
        L 180,
        F 24,
        W 5,
        S 5,
        R 180,
        W 1,
        N 5,
        F 6,
        R 90,
        E 1,
        F 52,
        F 77,
        W 4,
        F 34,
        S 3,
        R 90,
        E 1,
        E 5,
        N 5,
        E 1,
        S 5,
        R 90,
        W 5,
        N 4,
        E 3,
        W 3,
        L 90,
        E 2,
        L 90,
        W 3,
        W 5,
        F 49,
        N 1,
        F 48,
        W 3,
        N 4,
        E 4,
        F 100,
        E 1,
        R 90,
        F 25,
        S 1,
        W 2,
        N 2,
        W 1,
        F 25,
        L 90,
        E 2,
        F 96,
        W 2,
        S 1,
        S 4,
        F 91,
        N 2,
        R 90,
        W 4,
        L 90,
        E 4,
        F 78,
        L 90,
        S 1,
        W 3,
        F 56,
        R 90,
        W 1,
        E 4,
        L 90,
        N 5,
        E 1,
        R 90,
        F 53,
        E 5,
        L 90,
        E 2,
        F 82,
        E 4,
        L 90,
        W 2,
        L 180,
        F 51,
        R 270,
        F 37,
        N 5,
        F 15,
        E 4,
        F 16,
        E 2,
        S 1,
        E 4,
        F 91,
        N 4,
        E 5,
        N 5,
        L 90,
        F 9,
        W 2,
        F 64,
        S 4,
        F 72,
        W 2,
        F 31,
        S 4,
        R 90,
        F 40,
        W 3,
        R 90,
        F 50,
        S 1,
        F 61,
        W 3,
        F 90,
        N 5,
        F 76,
        S 1,
        L 90,
        E 3,
        R 180,
        F 19,
        L 90,
        W 3,
        F 70,
        E 3,
        F 35,
        R 90,
        L 90,
        N 1,
        W 5,
        R 180,
        E 2,
        N 5,
        F 34,
        W 4,
        S 1,
        E 1,
        N 5,
        E 1,
        N 2,
        R 90,
        W 4,
        S 1,
        L 180,
        E 5,
        F 59,
        E 1,
        R 90,
        S 2,
        L 90,
        S 4,
        R 90,
        W 2,
        N 5,
        F 60,
        W 1,
        R 90,
        F 35,
        R 270,
        W 5,
        F 100,
        W 2,
        R 90,
        N 2,
        S 5,
        S 3,
        E 1,
        S 2,
        F 36,
        W 1,
        F 90,
        R 90,
        S 3,
        E 3,
        F 5,
        S 4,
        R 90,
        E 3,
        R 90,
        N 3,
        L 90,
        S 1,
        F 74,
        S 2,
        R 180,
        E 4,
        S 5,
        F 13,
        S 3,
        E 2,
        F 92,
        N 5,
        F 2,
        N 4,
        F 3,
        E 2,
        L 180,
        W 3,
        N 3,
        L 90,
        E 4,
        F 21,
        W 1,
        F 76,
        W 5,
        F 56,
        E 4,
        R 180,
        F 100,
        E 1,
        F 29,
        L 90,
        F 96,
        N 2,
        F 43,
        R 90,
        F 26,
        N 3,
        F 15,
        L 180,
        E 3,
        R 180,
        N 3,
        E 3,
        R 90,
        F 7,
        L 90,
        W 2,
        F 33,
        R 90,
        E 5,
        S 4,
        E 2,
        E 3,
        F 34,
        F 66,
        N 4,
        F 14,
        W 3,
        N 2,
        R 270,
        F 66,
        E 4,
        S 5,
        W 5,
        R 90,
        S 5,
        W 5,
        L 90,
        S 4,
        L 90,
        F 69,
        E 5,
        R 90,
        W 5,
        S 5,
        W 4,
        R 90,
        N 3,
        E 4,
        F 14,
        W 3,
        F 24,
        S 3,
        F 48,
        L 180,
        E 1,
        R 90,
        F 36,
        N 4,
        L 90,
        F 68,
        E 4,
        F 59,
        E 5,
        R 90,
        N 2,
        E 4,
        N 5,
        F 56,
        R 90,
        R 90,
        F 91,
        W 3,
        F 24,
        L 90,
        F 56,
        S 5,
        F 59,
        S 4,
        F 36,
        N 1,
        W 3,
        R 270,
        L 90,
        F 86,
        L 180,
        F 33,
        N 5,
        E 4,
        L 90,
        F 14,
        S 3,
        L 90,
        N 5,
        L 270,
        E 5,
        S 4,
        L 180,
        W 5,
        N 2,
        L 90,
        E 3,
        F 69,
        R 90,
        S 5,
        R 270,
        N 3,
        F 70,
        E 2,
        N 2,
        F 3,
        R 90,
        S 5,
        L 180,
        F 59,
        W 3,
        F 67,
        R 180,
        F 74,
        E 4,
        F 4,
        L 90,
        N 4,
        R 90,
        S 5,
        F 6,
        S 1,
        E 3,
        N 4,
        W 3,
        F 24,
        E 1,
        S 1,
        E 4,
        S 2,
        F 82,
        N 3,
        L 90,
        E 1,
        S 2,
        R 270,
        N 4,
        E 1,
        N 3,
        F 32,
        R 270,
        W 4,
        R 90,
        E 4,
        F 33,
        N 5,
        W 3,
        F 34,
        E 2,
        S 1,
        W 3,
        W 4,
        E 2,
        L 90,
        N 5,
        W 3,
        S 1,
        F 86,
        E 4,
        F 99,
        S 1,
        L 90,
        S 2,
        E 2,
        L 90,
        F 100,
        N 5,
        F 19,
        L 180,
        W 1,
        F 25,
        N 3,
        F 25,
        R 90,
        W 4,
        N 4,
        R 180,
        N 2,
        E 5,
        R 90,
        F 66,
        N 5,
        E 2,
        L 180,
        L 90,
        E 1,
        S 2,
        R 90,
        W 3,
        S 1,
        S 2,
        L 90,
        F 93,
        L 90,
        W 2,
        R 270,
        F 73,
        N 4,
        L 90,
        F 44,
        R 90,
        N 1,
        W 3,
        R 90,
        F 69,
        N 5,
        L 90,
        N 1,
        R 90,
        F 35,
        F 89,
        E 4,
        F 31,
        W 3,
        R 270,
        W 1,
        N 2,
        E 5,
        L 90,
        W 4,
        W 1,
        F 93,
        E 4,
        F 18,
        N 4,
        F 31,
        W 5,
        N 4,
        L 90,
        N 1,
        E 2,
        R 270,
        F 34,
        N 5,
        W 2,
        L 270,
        W 3,
        F 44,
        S 3,
        F 47,
        W 2,
        F 86,
        N 4,
        R 90,
        S 5,
        R 90,
        F 4,
        E 3,
        L 180,
        W 5,
        R 180,
        F 89,
        L 180,
        F 46,
        N 3,
        F 76,
        R 270,
        S 2,
        F 62,
        R 90,
        S 2,
        F 28,
        R 180,
        F 47,
        E 4,
        N 4,
        R 90,
        S 4,
        E 3,
        R 180,
        N 1,
        F 92,
        R 180,
        F 86,
        N 3,
        R 270,
        F 47,
        E 4,
        S 4,
        W 2,
        F 67,
        N 5,
        W 3,
        N 1,
        F 98,
        S 1,
        E 4,
        N 3,
        F 97,
        E 3,
        F 69,
        E 3,
        F 38,
        E 3,
        S 4,
        E 5,
        F 81,
        E 3,
        F 5,
        E 3,
        R 90,
        W 2,
        N 4,
        W 3,
        F 94,
        L 180,
        F 30,
        N 1,
        F 91,
        S 3,
        F 89,
        E 1,
        F 68,
        N 5,
        E 5,
        F 89,
        L 90,
        W 1,
        N 5,
        F 79,
        R 90,
        F 44,
        E 4,
        R 90,
        S 1,
        L 90,
        E 5,
        N 3,
        R 90,
        W 3,
        N 4,
        F 83,
        E 5,
        S 4,
        F 82,
        S 2,
        F 29,
        R 90,
        S 1,
        R 180,
        F 49,
        E 5,
        N 1,
        L 180,
        R 180,
        S 3,
        L 180,
        S 3,
        F 55,
        S 3,
        F 70,
        W 5,
        N 2,
        W 2,
        R 90,
        W 1,
        F 93,
        L 180,
        L 90,
        R 90,
        L 90,
        E 3,
        L 90,
        S 3,
        R 90,
        W 5,
        N 4,
        R 90,
        S 1,
        R 90,
        W 5,
        F 100,
        W 4,
        N 2,
        F 84,
        F 76,
        E 5,
        L 180,
        S 4,
        F 85,
        R 90,
        L 90,
        F 68,
        R 90,
        S 4,
        W 2,
        L 90,
        E 1,
        F 19,
        N 2,
        L 90,
        N 4,
        E 5,
        N 1,
        L 90,
        F 75,
        F 42,
        R 90,
        S 5,
        E 4,
        N 1,
        E 4,
        F 7,
        N 5,
        L 180,
        N 4,
        E 5,
        L 270,
        F 6,
        R 180,
        W 5,
        F 93,
        L 180,
        S 1,
        R 90,
        F 66,
        N 4,
        F 83,
        N 1,
        F 10,
        S 2,
        L 90,
        F 80,
        W 1,
        R 180,
        E 2,
        L 90,
        S 4,
        F 53
       ]

  ys = [F 10,
        N 3,
        F 7,
        R 90,
        F 11
       ]
