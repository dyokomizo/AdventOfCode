module Day3 where

  r1d1 = slope 1 1
  r3d1 = slope 3 1
  r5d1 = slope 5 1
  r7d1 = slope 7 1
  r1d2 = slope 1 2

  trees = product $ map ($xs) [r1d1,r3d1,r5d1,r7d1,r1d2]
 
  slope r d = go 0 . map (concat . repeat)
    where go n ls@(_:_) | length ls > d = go (n + hit ls) $ slide ls
          go n _                        = n
          slide     = map (drop r) . drop d
          hit       = bit . (=='#') . (!!r) . (!!d)

  bit True  = 1
  bit False = 0

  xs = ["....#..#.......#........#....#.",
        "..##.#.#.#...................#.",
        "....#.#.##..#....#......#......",
        ".........#.#......##.....#.....",
        "..........#.###.##...##........",
        "#....#.#.......##.....#..#.....",
        "#...........#.#...#..#..##.##..",
        "......##.............#.....#...",
        "..##..........###..#.#..##.....",
        "...........#........#......##..",
        "..##...........##..............",
        "..#......###.#.....#.#.#.......",
        "..#..#..#..........#.#....#....",
        ".#.....##......................",
        "...#...##..#...#.........#..##.",
        ".#......#..#..#...#......#.##..",
        "..##.##.......#..#.....#..#...#",
        "..............#..#..#...#......",
        "...#...#....##.....#...#...#...",
        "......................#...#....",
        ".......#......#...#..##...#.#..",
        "##......#..#.....#....#.....#..",
        "....#.#.##.#.#....#............",
        "#.....##.............#.........",
        "..........#...........#.#.....#",
        "...#...##....#.#........#..#...",
        "................#..#.##.##....#",
        "......#...#...##...##....#.....",
        "##....#..#..#...#..#...........",
        "#..................#...#.#..#..",
        "....##....##.#....#..#......#..",
        ".....#...........#.........##..",
        "..#..............#.........#..#",
        "......##....................#..",
        "..#.....###...####...#...#.##..",
        "#..#.#......#.....#.......#.#..",
        "##.#.........######........#...",
        "..#....###...#.#..............#",
        ".....#..............#.........#",
        "....#......#..#.........#...#..",
        ".....###.....#.###.......###...",
        "#.#..#.....#....##...#........#",
        "..##....#..#.........#...#.#...",
        "..#..##.............#....#.#.#.",
        "..##.#..#.#.#.........##.......",
        "#.#..#.........#..............#",
        "#..#.........###.......#.#..#.#",
        ".............#...#....#......#.",
        "..........#.#...##.###.....#.#.",
        "..#.....#......................",
        ".......#......###.#.......#....",
        "....#....#.........#...###.#.#.",
        ".#.............#............#..",
        "....#..#.............#.#....#..",
        "....#.....#...#...##.#.........",
        "..#...#...#..................#.",
        "........#....#.....#...........",
        ".....##.......#...#.#..#..#....",
        "...#............#..#.#.........",
        "......................#........",
        "....#......#.....#.#....#......",
        ".....#..#.........#.........##.",
        "...............#.....#....##...",
        "...#.#.#...#..#...........#....",
        ".#....###......##...#.#.#.#....",
        ".....#...#....####....##.......",
        "..#......#..#.....##.#...#.....",
        "...#.##..#....#..##.....#......",
        "..#......#...#...##.....#...#..",
        "......#.....#........#.........",
        "..#.#....#..............##....#",
        "..#...#......##............#...",
        ".##.#.......#.......#......#..#",
        "...##.##...#.....#.......#..#..",
        "......##..#....#.......#.......",
        ".....#..#..#.#.....#.....#...##",
        "##.#...#.#.#.....#...#.#.#.##.#",
        "...................###...#..#..",
        ".#.....##.#......#........#....",
        ".##...##.#..........#...#....#.",
        "......#..............#.#......#",
        "...#.......#..#...........#....",
        ".###...#............##..#...##.",
        "##..#.#.........#............#.",
        "#...#.#......#.##...........#.#",
        ".#.#...#........#......##......",
        "....#...#...#.....#...#....#...",
        "...##...........##.........#...",
        ".........#...#..###............",
        "..#........#...............#...",
        ".............#....#.#..........",
        "........#......#.#.......#....#",
        ".................#....##.#.##..",
        "..#...##........#..............",
        "#..#........#...#....#.........",
        "......#.#.....#.....#..###.#..#",
        "....#............#...#.#.#.....",
        "............#..........#...#...",
        "..........#....##.#.........#..",
        "..............#...#...#..#.....",
        "#......#....#..##....#......##.",
        "...#....#.................#....",
        ".#.##.............#...#....##..",
        "....#..#.........#..#....#....#",
        "..#.....##..#......#.#..#......",
        "..#..#.....#........#...#..#..#",
        ".........##.#.##.#.......#....#",
        "..#.......##.##...#.....#.....#",
        ".............##...#...........#",
        "..#......#..#....#...#..#.##...",
        "....#........#......#.........#",
        ".......#........#..#.#.#..##..#",
        "..#......#...........##...#....",
        ".....#..#.#...#..............##",
        ".#..#......#......#........#..#",
        "...##...............#....#.....",
        ".......#...#.......##..#.......",
        ".....#....#...#...#..#.....#.#.",
        "...#.........#.....#...........",
        "...#.....###....#....#...#...#.",
        "#..#.....#.........#.........#.",
        ".................#.#.....#....#",
        "...........#..........#..#.....",
        "........#.#....#...#..#.....###",
        "#............................#.",
        "..##..#..#...##.........#......",
        "......##....#.#...#.........#..",
        "......#..##.#......#..#.....#..",
        "...#.......##....#.#....#......",
        ".....#........#...#............",
        "#.......#...#.........#......#.",
        "......#......#....#..#.........",
        "..#.#........#..#......#....#..",
        ".#..#.#..........##....###.#..#",
        "...#....#.##..#...#....#.......",
        "..#.....#......#.###.......#...",
        "..............................#",
        ".....#..#...#...........#......",
        ".##...#....##....#.#.#.#....#.#",
        ".#...#....#...#........#.......",
        "....#............#...##..#.....",
        "....##..#....#....#.....#....##",
        ".............#..##.#.#.#.......",
        "#.......#.#.#.......#..#..#....",
        "#..#...........#.......###..#..",
        ".#..##.#.....#........#........",
        "..#.#.......#............#..#..",
        "...........#..#............##.#",
        ".....#.......#.....#..#.##.#..#",
        "......#......##.....##.........",
        "..##.#..#.#..#..#..............",
        ".....#.............##...#.#.##.",
        ".#......##.#..........#........",
        "..#..#.........#.....#.#.#.....",
        "..#.....#.......#.....#..#.....",
        "#.#.#........#.#...#....#..#...",
        ".#.#.......#............#....#.",
        "......#..................#....#",
        ".#...#...#.....#.#..........#..",
        ".#..##....####...........#.#...",
        "..##.....#...#.#....#....#.....",
        "#.....................#....#.#.",
        "###..###.#.#...........#.....##",
        "......#......#..........#......",
        "...#......#.##.....#......###.#",
        ".............#..#.#...........#",
        "..#.............#.#..#.....#...",
        "...#...............#....##...##",
        "........#.................#....",
        "#..###.....#.......##.#......##",
        "....#.#..............#.........",
        "#..........#.....#..##...#.....",
        "................#...#..#....#..",
        "..#...#....##..........#.#.....",
        "......#........##......#..#...#",
        "...#....#..#.....#.......#...#.",
        ".#.....#..#...#..###....#......",
        "....#.........#....#.#.#.....#.",
        "#.#....#...#....#.....#..##....",
        ".......#..#..#..........#...#..",
        "..#.#..#.....##.#.#............",
        "..#....#.....#..##..#..#.#..#..",
        "..#.##.#...........#...#..#....",
        ".........#........#...#........",
        "..#.#.#.......##.........#.##..",
        "#.#..........#.#...#..#......##",
        ".#..#....................#.#...",
        ".##......#................#...#",
        "..##.#######......#....#.......",
        "....#...##.#....#.#............",
        ".##....#...##.......#...#..#...",
        "...........#...#...#...#..#....",
        "#...#.....#.......#....#.....#.",
        ".............#.................",
        "........#.#.......#...#.#.#....",
        "..............#............#.#.",
        "......#......##..#.......#....#",
        "##...#..................#......",
        ".....#......###.....#.......#.#",
        ".....#.#............#.#........",
        "..#.#..#............#....#.#...",
        "##.#.###.#.#.#..#......#.......",
        "...##........#..#.....#.#.#..#.",
        "##......#.##.....####..#.......",
        "............#...#..#...#..#....",
        "...#..#................##.#..#.",
        ".#....#.#...........##.#.#...#.",
        "####..#...........#.......###..",
        ".......#.................#.....",
        ".......#....#.......##....#....",
        "..#.........#...#....#.........",
        "..........#..#...#.#...##..#...",
        "....##..........#.........##...",
        "#.........##..#.#..#.......#...",
        ".#...........#....#...#...#.#..",
        "....#..#.....#...##....#.#....#",
        ".#....#.....#......#..##.##.#.#",
        "#......#..#.......##...........",
        "...#..#...#.#.................#",
        "......#.......##....##.#......#",
        "....#....#.#.#.....#....#....#.",
        "..#..........#.##...##..#......",
        "...#..#........#....#.#..#....#",
        "##.......#........#..........#.",
        ".#........#.......#...#..##...#",
        "..#..#..##..#...........#...###",
        "..#......#..........#..##......",
        ".#.....#..#.#...#...#.........#",
        "#.#......##....................",
        "#...#.....##...........#.......",
        "........#...#....#.......##....",
        "...#.##...#....#....#..#..#..#.",
        "...#..#......##....#..#..##....",
        "#...#..........#.#.............",
        "##..#........##.....#.........#",
        ".....#......#.#...###..#.......",
        "#..##.#..#.###...........##..#.",
        ".....#....#..........#.......#.",
        "##.........##.#................",
        "....#.........#............##..",
        ".......#........#......#..#..##",
        ".#...#...##..#....#..#.........",
        ".............#...#.#........#..",
        "......#..#...#..#.###..#.......",
        "........##.#..#.#..#..#........",
        "#.##..#..#..........#...##..###",
        ".##...#............#.#...##..#.",
        "................#....##.#...#..",
        "#.................#..........#.",
        "...#..#..#.....................",
        "..#...##.#.#...................",
        ".....#...#.......#............#",
        "..#..#.........#..##.#..#.#...#",
        ".....#.#.....#.#.......#.....#.",
        "..................#..#....#.#..",
        "..#.....###.##.......##....#.#.",
        "..#......##.......#....##.#....",
        "....#...................#..##.#",
        ".......#....#.##.#.......#....#",
        "..#...#......#..#...###....#.#.",
        "..#..#.#....#...........#.....#",
        ".....#..#..#.......#........#..",
        "......#.##.#......#...........#",
        "#...#....#.#..##.##..#..##.....",
        "#...##....#.#...##........#....",
        "..##............#.#.#..........",
        "....#.....#.#..#.......#..#....",
        "#..#.#.....#..#..##...#..##....",
        "...##........#...........#...#.",
        ".####......#..##.........#.#...",
        ".......#.......................",
        ".................#....#..#.....",
        ".........##......###...........",
        ".##......#.#.#....#.#...#..###.",
        "....#......##.###.#.#..#.......",
        "..........#.......##......##..#",
        "...........#.......#..##.......",
        ".....###..#..............##....",
        "........##..#.#.#......#....#..",
        "#....#.........................",
        "...........#...............##..",
        "......#.................#......",
        ".....#...#..##...##...#...#....",
        "..........#.#...##.####......#.",
        "..#.#.....##....#...........#..",
        "..........#....#..#....##...#..",
        ".#.......#..##...#...#.....#...",
        "...##....#.#......##...##....#.",
        "#.......#.......#.##.#...#.#...",
        "#...#..................#......#",
        "..#.......#...............#..##",
        "#.....#..................#....#",
        ".##.....#.....#......####.....#",
        "..#........#...#.#........#...#",
        "..##.....#....#...#...........#",
        "..#..#.....##..#.##...#........",
        "..........###..#....##.....#...",
        "...#...#....#.##.#...#.#.......",
        "..##......#.......#.......##...",
        "............#............#.....",
        ".##....#.........#.............",
        "....#....#....#........##...#.#",
        ".......##......................",
        "..........#.#.................#",
        "......##.#...#.........#.....#.",
        "..#...#......#..#.............#",
        "..........###.#..#.#...#..#..#.",
        "#..#.#..#....##...#...#.#...#..",
        ".#........##...#......#.##.....",
        "...###.#...##..............##..",
        "#.#.#...#...#..#....#.#..#.....",
        ".#.#.##..#....#......#.#.......",
        "...#..#.#....##...........#..#.",
        ".....##..##......#.#...........",
        "......#.....#....####....#.....",
        ".#.#.#...#..#..#...........#...",
        ".....#......................#..",
        ".........#.........#.###.##....",
        ".....#......##..........#......",
        "..#...........##...........#...",
        "..............#.........#.....#",
        "..#....#..#...#...##.#.........",
        ".#.#.#....#..........#........."
       ]
